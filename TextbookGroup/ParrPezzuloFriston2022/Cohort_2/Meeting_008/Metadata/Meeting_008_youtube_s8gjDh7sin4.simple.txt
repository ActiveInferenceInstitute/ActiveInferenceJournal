SPEAKER_00:
Greetings, everyone.

It is October 21st, 2022.

We're in textbook group number 50.1.

No, I just have a slight typo in my OBS.

It's cohort two and meeting eight.

We're discussing chapter four in our first discussion of chapter four.

We're going to, as we did not have any chapter or four specific questions from cohort two, today largely we're going to be reviewing and revising questions that were initially addressed in cohort one.

taking a second pass and seeing where we can like add some context and simple or complex or however questions that we can add.

So you can be adding in the chat or in the questions tables directly, or like just unmuting and addressing them so that we can have high quality and quantity

of a large diversity of questions on the material that people are curious about when they're reviewing the text before we go to the questions table does anyone have any general thoughts or comments on chapter four yes please ollie


SPEAKER_01:
As we discussed in the previous cohort, this chapter is probably the most technical one in the whole book.

So as people go through the formalism here in this chapter,

I think it's quite normal to not fully understand every single equation there, so in case there are some difficulties in getting the content of this chapter, I think some of these difficulties, not all of them, would be unpacked in the later chapters.


SPEAKER_00:
you very much totally agreed anyone else want to make a general chapter four comment yeah there's such an interesting rhythm chapter one being largely contextualizing and framing the chapter two three dialectic

the low road and the high road chapter four with a focus on the generative model and it is a very technical chapter chapter five whiplashing over to neurobiology and less on the fundamental formalisms more on the neurobiological relationships that constitutes the epistemic first half of the book

second half of the book has kind of a rhyming pattern but less focused on epistemic and more on pragmatic although the pragma of epistem whereas chapter six is focusing more on the recipe for making the model and less of the contextualizing then there's another chapter pair seven and eight discrete and continuous time

And then chapter nine, which is where we're heading into in just 50 minutes in the first cohort with model-based data analysis.

And then chapter 10 as sort of like the symmetry of chapter one and the three appendices.

Okay.

If anyone has comments, of course, just like raise your hand or speak up or put it in the chat or however.

I'll un-upvote these so we can upvote them when we've gone through them today.

Okay.

Well, let's scroll through the chapter before we go to the questions just to get a view of it.

This chapter complements the preceding chapter's conceptual treatment of Act-Inf with a more formal treatment.

It sets out the relationship between free energy Bayesian inference, the form of generative models, and the dynamics obtained from minimizing free energy.

The key focus is on how time is represented.

4.2 Bayesian Inference to Free Energy Equation 401 recalls Bayes' Theorem.

Figure 4.1 describes Jensen inequality, which is related to the tonicity of the natural log or just the logarithm function in general.

And it's a pretty fundamental point.

And it speaks to the advantage of using, for example, log probabilities and the different kinds of operations that are possible on logged values

Here is an application of Jensen's inequality to derive a free energy value as a bounded, as a bounding.

rearrangements amongst Bayes' theorem and free energy.

Generative models.

To calculate the free energy, we need three things.

Data, a family of variational distributions, and a generative model comprising a prior and a likelihood.

This section has two types of generative model.

The first is dealing with categorical variables.

The second deals with continuous variables.

Figure 4.2 is helping gain some familiarity with like nodes and edges in a Bayesian graph.

So here in a Bayes graph,

nodes are variables circular nodes are variables and edges which are like labeled with a with a box reflect their relationships so one can imagine and we'll return to this in the questions these map on to situations where like there's a hidden cause and an observation you know temperature in the room thermometer reading

two things that influence one outcome, one hidden thing that influences two outcomes, a hierarchical model where something changes something that results in an outcome, and so on.

And then the boxes are labeled according to the way that we might see that in a more formulaic conditional likelihood expression.

vertical line means conditional upon so like box two is the probability distribution of y conditioned upon x because of the directedness of this arrow figure four three is a very central figure in the textbook and it

sets up the similarities and differences largely between the discrete time and the continuous time formulations of active inference generative models in terms of partially observable markov decision processes through discrete time and for the um more uh taylor series expansion like approach used for continuous time

Does anyone want to give a thought or an overview on what is happening in Figure 4-3?

Yes, Ali.

And then anyone else?


SPEAKER_01:
Well, the top figure is what happens when we want to model discrete time event.

And the bottom one is more conducive to modeling continuous time phenomena.

So as we see, they're quite parallel and the only difference or at least the most important difference here is the role that policies play in the discrete time case and the v play in the continuous time case, the policies denoted with the pi and the top figure

And the top figure relates to the POMDP approach to modeling the discrete time phenomena, as we'll see at length in Chapter 7.

And the bottom one is unpacked in Chapter 8, I guess.

Excellent.


SPEAKER_00:
Again, anyone can raise their hand and go for it, but just to kind of describe what the nodes and edges are here, we'll be thinking about like the temperature in the room is the hidden state and the thermometer is the observation.

So in the discrete time formulation, this is the temperature in the room through time.

It's the hidden state.

It's in the generative process.

Then there's an A matrix.

here labeled as two which is the distribution of observations on the thermometer conditioned upon the temperature at that time so the a matrix can be used as a recognition density to do inference on the hidden state given the observation or it can be used in a generative capacity given a temperature to emit distributions of thermometer observations the three corresponds to the b matrix

which is the distribution of the state at the next time conditioned upon the state at the given time and the policy pi.

So three or B describes how the temperature is changing through time.

So this kind of through line of hidden state and then a B matrix or three, and then a hidden state, this is something changing through time.

And then pi is policy, which is a function of the decision-making of the entity.

it influences how states change through time that's the discrete time formulation time point negative one zero and one or however um and often you see a d or a prior which is uh how the first hidden state value gets initialized that's the discrete time formulation

In the continuous time formulation, they're being laid out side by side because the isomorphy of the models is apparent.

They have the same topological structure.

However, there are some really important differences.

Rather than describing how a hidden state changes through time at explicitly demarcated time points, like minute 12, minute 13, minute 14,

um what's happening here is that the the value of the hidden state at the focal time is still in an a matrix relationship with observables so the probability of y given x is exactly analogous to this one of the observations conditioned on the hidden state however taking the place of the b matrix

three above here, which describes how hidden states change their time in the discrete time formulation, is actually a edge that describes the derivative of x conditioned upon x and v, which relates to slowly changing causes in the world, analogous to policy.

And so this is actually not doing explicit prediction of future explicit time points.

but rather it's doing something like a Taylor series expansion, where as you take more and more derivatives further and further away from a focal point, you gain better and better approximation through power series expansion from a focal point using higher and higher derivatives.

here's like an example here's a sine wave and the first derivative just gives you this locally linearizable range but there's a well-defined computational complexity for a taylor series you can say the zeroth order is just zero and the first order just a linear regression

And then there's just a quadratic.

And then there's just a third power relationship and so on.

And so as you get more and more getting into the blue and the purple and so on, you get better and better fit and you extend the range of fit further and further out.

And it always gets strictly better.

This is going to come back in chapter 7 and 8, which are going to focus more directly on the discrete and continuous time formulations.

But for here in 4, they're just being introduced as different ways that we can have a generative model in active.

So now, section 4.4 can come to the top of 4.3.

are some formalisms related to categorical distributions that are compatible with partially observable markov decision processes here's an expected free energy g that describes some different partitionings on as a function of policies

evaluating policies based upon their impact on the pomdp four key ingredients for the discrete time generative model a b c d then moving to continuous time

But first, there is kind of a technical interlude on Markov blankets.

Previously, there was a box defining the Markov blanket, and here it's discussed in the context of message passing.

Yes, Giuseppe, anywhere you want to call attention to.


SPEAKER_02:
Thank you, Dan.

Going back to the figure 4.3,

So in looking at the parallel between the top and the bottom figure, so in the top figure, pi, that is the policy, is obviously something that is selected by the agent, right?

What about nu in the Greek letter that is

that is parallel to pi in the bottom figure new is it because it said slowly slowly varying causes in in the environment or something like that but is that something emitted or selected by the agent or is it something because


SPEAKER_00:
Yeah.

Yeah.

Does anyone have a thought on this?


SPEAKER_02:
The distinction is just between discrete and continuous is not between like, something that that it's autonomous, autonomously selected by the agent or something that is happening in the environment, right?


SPEAKER_00:
Ali,


SPEAKER_01:
Actually, in continuous time situation, the new here can also be related to the non-cognitive aspects of the system, such as the attractors of the system.

So that's why it's described in terms of the slowly varying causes.

For instance, in chapter 8, we will see that, well, we have some static variables according to which the system behaves.

So that's not exactly something that the system will choose per se.

It's some variables or some states towards which the system will approach.

So that's why they termed it in that way.


SPEAKER_02:
So, for instance, when applying to movements, that can be some sort of anatomical constraint of the movement, something like that?


SPEAKER_00:
exactly yeah i see okay thank you yeah thank you for um sharing that ali it reminds me of the question that came later action is part of in this is chapter eight action is part of the generative process not the generative model and so the actual

interpretation of slowly varying causes and the mapping of slowly varying causes to real world phenomena is one interesting area another general point

is that if we look to the figures, we'll see that the first figure is the action perception loop.

And initially, there's some usage of the Bayes graph in terms of elaboration on the action perception loop, and so on.

But when we get to chapter four and the generative model, we don't see the action perception loop represented the same way.

And so it's an interesting question to ask where these variables map onto, for example, the entity model.

This isn't simply an entity model.

Okay, so just completing our quick scan before we go to the questions.

Message passing and Markov blankets.

This is definitely an area that we could learn a lot more about.

And this is also an area where software packages exist with the work of the BIAS lab and their Forney package.

okay figure four four bayesian message passing does anyone want to describe this figure just one thought well the overall thought is is this supposed to be something that we're supposed to in detail

understand or is it more like an illustrative representation i was thinking exactly the same it's like here's the kind of food you could make or is this like here's how you make this one dish um there are uh

Also, it's not read from left to right per se at the level of the figure.

The caption begins with a right.

So starting with the left, the scheme could be expanded hierarchically, collapsing over time steps and policies for simplicity.

So just looking at the left one, here the subscripts have I on the bottom.

Then the subscripts have I plus one.

but you see the same squiggle, pi, s, epsilon.

So this is showing that within the context of a hierarchical model, you can have recurring patterns of topological relationships of a Bayes graph to enable, for example, hierarchical predictive processing, ACT-INF, Bayesian action selection, et cetera models.

And then that is collapsed over time steps and policies.

So what's happening here?

So this is going to be unpacking within one layer on the right side.

And we see like, so here there's no superscript, but we can just take that to be like pi i. So this is going to be this quartet being expanded out.

So here's O tilde, like O through time coming in.

And here's like the actual discrete time observations coming in.

Here's epsilon and S in a predictive processing capacity.

And these are illustrating with labeled edges, some of them.

relationships between these different variables squiggle in this case that's funny when you search for the squiggle it finds the it finds the other sigma as well squiggle sub pi t

is two natural logs being subtracted.

A natural log subtracting another natural log.

So what happens when you subtract, what's log A minus log B?

It's the same as log A divided by B. Log, open parenthesis, A divided by B. So this is computing a ratio between the observation and the preference.

if that is one then the incoming observations are exactly the preferences the preference distribution if there's a surplus then the observation is higher if there's a deficit below one then it means that it's lower i hope that is correct way to say it um

So here's message passing and relationships amongst variables.

And we see that kind of like with an epsilon intermediating, we see the S relating to the O at a given time.

So this is a lot like the A matrix.

And here's the role of policy.

Now we're in the continuous time.


UNKNOWN:
4.5.


SPEAKER_00:
Ali, please.


SPEAKER_01:
I think this figure can be usefully compared with figure 7.12 because I believe the figure we'll see in chapter 7, 7.12, I guess.

Yes, that's it.

Is the...

I mean, the other interpretation of this figure from chapter four in terms of its hierarchical relationships, but from a graphical probabilistic modeling point of view.

And the other thing is that, I mean, final position sigma, I don't think,

It's defined explicitly in the text, but it's been defined as the expected prediction error in the step-by-step tutorial paper.

So yes, that's also, I wanted to mention that definition as well.


SPEAKER_00:
Thank you.

this step-by-step tutorial which is also a four-part model stream is very very useful in some ways it is almost textbook length whereas in chapter four there was first the general discussion of base graphs

like again, one cause, one observation, one cause, two observations, two to one, one to one to one, and then instantly into the juxtaposition between discrete and continuous time.

As we've looked through today, in contrast, the approach taken in step-by-step first off is to only focus on the discrete time formulation, but then they walk through a sequence

of graphs and connect them to like increasing levels of complexity building towards the one that we see in 4.3 it's a little later than one might expect in the paper

Sorry about that, here it is.

Starting with just a simple graph that is exactly analogous to the one on the top left.

So they start with a static perception.

Then in the step-by-step, they introduce this kind of E motif,

by showing a prior and three time points, two changes, observations mediated by the A. This is corresponding to the music listening example that's going to come up later in the textbook.

Then policy as a way to influence state transition matrixes is introduced on the top right.

and free energy as an objective function guided by preferences to do policy selection as inference and then finally on the bottom right there is some precision on policies which is just to bring in another variable beta and gamma which have like a inverse relationship to each other so that you can talk about like um high precision as

low ambiguity and vice versa so it's a different ordering of talking about generative models okay we're in the continuous time branch i'm just copying a link that ollie sent


SPEAKER_01:
Sorry, I just wanted to mention that the continuous time counterpart for that step-by-step paper might be this one from 2017 by Raphael Bogach, because in this paper it almost exclusively deals with the continuous time active inference.


SPEAKER_00:
Great.

Generalized coordinates of motion.

This is again bringing back this idea of the Taylor series.

If this black line is the function that has to be approximated, if you only have one parameter to approximate it and you want to do it at this line, your first is just the actual value of the function at t equals zero, tau equals zero.

then the first derivative.

Value at the time X of O and the first derivative, then adding in the second derivative and so on.

So as you add more and more and more derivatives, you'll get better and better approximation to arbitrary functions.

And you'll get that with a totally known form

that can be represented in a vector as the generalized coordinates of motion.

And in physics, it's used in engineering, it's used in PID control.

This has come up in many live streams and discussions because you can say whatever function I'm approximating, I want the first five derivatives.

And then you know that your data structure is only gonna have five coefficients, for example.

And they've joked many times, like six generalized coordinates are sufficient, six layers of the brain cortex regions, though in some ways that's kind of, that makes it seem like the six layers of the cortex are like this

actually the cortical column is not like little six floors where each one is its own predictive loop actually the layers are connected differently more formalisms in the continuous time setting with generalized coordinates of motion tilde over a variable is representing trajectories

One footnote is that this is still in the state-based base of Bayesian mechanics.

Ali or anyone else, please correct if this is not the case.

So the tilde here is a summary notation helping us represent trajectories of states, which is moving us towards the path formulation of Bayesian mechanics.

but is not the same as a true path formulation.

Hope that is fair to say.

The Laplace approximation?

Yes, Giuseppe, please.


SPEAKER_02:
Yeah, so in the tilde formalism now,

when we are talking about generalized coordinates.

If we were talking about standard coordinates, X tilde would be X at time T comma X at time T plus one, X at time T plus two, et cetera.

Now in the generalized coordinates, the X tilde would be X comma T plus one.

first derivative of x, comma, second derivative of x. Is that correct?


SPEAKER_00:
Yes.

So O tilde with just a location coordinate would be either a list or a vector, depending on whether you want to think about it in terms of a list with comma or in terms of a vector going down through time.

Yeah.

Then with generalized coordinates,

it is a matrix.

So just it could be represented differently.

But here, let's just say that we're going to be working with it as a list, like you said.

So in this case, columns correspond to the list above.

Those are the time points.

rows going down are the generalized coordinates of motions.

so for each time point one two three four five we have a vector which is describing the location the first derivative the second derivative and so on i see i see so there would be six rows cool if we had six generalized coordinates of motion

And this is used and discussed in Livestream 26, particularly, and several other places.

Generalized coordinates are like

They're kind of not like a trick or anything to get dynamics into a static representation.

Like if you just take a picture of a car, you can't tell if it's moving or not.

But if you said this is a generalized picture of a car, it's at 12 on the number line and its velocity is 10 this way,

and its acceleration it's slowing down and it's going to the right and the way that it's slowing down is speeding up then you can start to say a lot more about the next steps of the car exactly and that is representable in a static um snapshot ollie


SPEAKER_01:
Another way to looking at the generalized coordinate is to see it as a dimension reduction technique, because when we want to describe as a very simple case,

a trajectory in a cartesian coordinates well we'll definitely need at least for example in a two-dimensional trajectory we'll need two dimensions but if we look at it from a generalized coordinates perspective we can just put it into the Riemann manifold

and jettison one of the dimensions which encapsulates that trajectory through a specific time.

So one of the dimensions would be reduced, and then we can just look at the trajectory directly, look at the behavior of the trajectory directly from the consecutive derivatives we take.

So that's a dimension reduction technique as well.


SPEAKER_02:
next point yeah when you said uh you said on the romanian romanian romanian manifold you said can you

Can you explain that?


SPEAKER_01:
Yeah, because in the Poincaré or Riemannian manifold, we're dealing with not exactly the Cartesian coordinates, but it's just the state space defined as these kind of generalized coordinates.

So it is already a one-dimension reduced coordinate, so to speak So that's the whole point behind encompassing the state space in that Riemannian manifold, not in the Cartesian coordinates

because Cartesian coordinates need some global coordinates to define the states of the space, but in generalized coordinates it's more like a kind of localized coordinates, not global ones.


SPEAKER_00:
yes this is very well i don't know i don't know much about the romanian or the punker manifold so we also have some readings to to do to understand that but yeah this is very deep and powerful um analytical insight one other way to think about generalized coordinates as a dimensionality reduction technique from a more computational applied perspective is

if you want five coordinates of motion you know exactly the size of that data object if you say i'm going to consider 20 time points and five generalized coordinates of motion you know exactly the shape of that parameter or that variable now whether that captures whether that manifold

or subspace captures 10 or 90 or 100% of the variance in the original space is situational.

But you will capture some variance, just like every principal component analysis will capture some variance in the space.

And whether it captures enough is situational, but

you know you get some and you know that you've reduced the dimensionality to a well-defined amount which in many cases is um essential versus having like an unbounded number of of unbounded size um the motor reflex case has been especially studied from the continuous time perspective

That's going to come up in the second half of the book.

It comes up in a lot of different other cases and in chapter five, motor reflexes.

Box four three describes the Laplace approximation.

I'll just note again as frequently that last names don't really reduce uncertainty about what something is talking about much of the time.

And so there'd be ways to describe some of these things that wouldn't rely as much on specific last names because there's like a many to many mapping between the technique and different last names and so on.

But just working with what we have, Laplace approximation is a quadratic approximator that is an expansion around the mode of a distribution.

So the procedure for generating a Laplacian approximation is you find the mode of a distribution, which is the tallest point on the distribution.

Then an upside down parabola is like a fit to that mode.

The tip of the parabola is going to be the mode of the distribution.

The width of the parabola is going to reflect a second parameter, a variance parameter that captures as much as possible of the original distribution.

So this is kind of like...

A good thing about Laplace approximation is that no matter what shape the original distribution has, you know your Laplace approximation is only going to need two parameters, the mode and the variance.

And so in that way, it's a lot like a Gaussian approximator, although the Gaussian function is different than the quadratic approximator.

They're similar because they both have two parameters.

the location of the midpoint and how wide the function should be stretched.

So for empirical distributions, which might not fit cleanly to any specific analytical family, this can be very helpful because again, you know that some density of the target distribution will be captured.

Now, if you're dealing with like a super tricky distribution where there's four humps, all of very similar height, then the Laplace approximation is gonna get tricked because it's only gonna capture like at best 25% of the variance.

And it's gonna, you're gonna be very much like unaware of these other three big peaks.

However, four distributions that have a central tendency

broadly speaking.

The Laplace approximation does extremely well.

Some of these subtleties between like Laplace approximation, variational Bayes and non-parametric bootstrap Bayes sampling techniques are explored in the SPM textbook, especially.

All of this

was still inferential but not action including and that is very analogous to the approach taken in the paper discussed in uh live stream 43 which is on predictive processing itself predictive coding a theoretical experimental review

In this one, 80% or something of the paper is about hierarchical predictive processing architectures.

And then they go, all right, now we're just going to slip in action.

And it turns out to play very well.

Here we see a figure that's kind of resonant with this one.

We have a discrete time formulation here.

We know that because we see an explicit time variable and a time minus one and time plus one.

So that's how one knows that they're dealing with a discrete time formulation, even if the variables were called different things.

In contrast, we see a hierarchical architecture again, but

everything has been transposed into the notation of the continuous time where we saw like Y coming in whereas we saw O coming in here and that was what we saw in four three O coming in to discrete time Y coming in to continuous time

so this figure four six is like related to the previous message passing figure and then there's a summary so chapter four as Ali mentioned at the beginning is relatively technical there's a lot of techniques and notation

and forays into more general topics ranging from Jensen's inequality at the beginning of the chapter to generalized coordinates of motion message passing in the context of Markov blankets evidence lower bound and free energy calculations and all of that is being done in this side by side way between discrete and continuous time

And that is broadly what chapter four describes.

All of that is being done because we're exploring generative models in active inference.

Okay, in our final minutes, what are some thoughts or ideas that people have that we can come to next week?

Yvonne?


SPEAKER_03:
I'm fast now.


SPEAKER_00:
What does it mean to understand Chapter 4?

What are we looking to get out of Chapter 4?


SPEAKER_03:
I think a good understanding of the discrete and continuous time distinction is, in my opinion, the essence of what is in chapter four.

But I would like to understand more about the message passing, because I don't really get it all the way.

as I would also love to pick apart and understand the larger paper on message passing by Friston and some colleagues that I don't remember.

Yeah.


SPEAKER_02:
Yeah.

For me, the greatest challenge is that even though you're beginning to grasp the theoretical

uh details the the moving from there to actually implementing something is is still uh still quite difficult um and uh you know freestone says uh quotes

a lot of time Feynman saying you can only understand when you start when you can do it but still it's a that passage in active inference is still quite challenging for me

even after having read the whole book and a few of the other papers.

So this is the, even though you understand this chapter four, which has a lot of the theory, but still going from there to implementing a model, it's not easy.

I don't know if there's something that affects everybody.

It does.


SPEAKER_00:
affect me for sure well certainly it does it's the fractal state of play at this moment that's why people aren't just like blasting out active models because there's like a lot of uh trails to blaze and also just as always compare it with a linear regression you could read a 100 500 10 000 page textbook on linear aggression

And then you'd sit down in front of your programming language and you may not specifically know how to quote, apply linear regression.

Linear regression has had a hundred years of empirically focused development on data input, output, visualization, training, model adequacy, model selection.

There are just whole areas of applied statistics that haven't turned their attention to this area, which is why we're doing it.

so the most ancient comparator is linear regression then to get one step closer to seeing what the theory practice synthesis looks like the spm textbook documentation and literature help us see what it could look like and then it'll have aspects of both of those and some novelties

very well thank you all for this fun meeting thank you see you next week thank you bye-bye