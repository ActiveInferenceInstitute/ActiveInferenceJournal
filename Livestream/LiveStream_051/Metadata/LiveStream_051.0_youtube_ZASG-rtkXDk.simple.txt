SPEAKER_00:
All right.

Welcome.

It is ACT-INF live stream number 51.0.

This is the background and context first discussion for Canonical Neural Networks Perform Active Inference by Isamura et al.

It's October 26, 2022.

Welcome to the Active Inference Institute.

We're a participatory online institute that is communicating, learning, and practicing applied active inference.

You can find us at some of the links on the page.

This is a recorded and an archived live stream.

So please provide us with feedback so we can improve our work.

All backgrounds and perspectives are welcome and we'll be following video etiquette for solo live streams.

head to ActiveInference.org to learn how to get involved with Active Inference Institute projects.

Today, it's the first of several discussions that we'll have on the paper, Canonical Neural Networks Perform Active Inference 2022 by Takuya Isamura, Hideaki Shimizaki, and Carl Fristen.

The video is just an introduction to some of the ideas.

It's not a review or a final word.

there will be an overview of the structure of the paper and then we'll go through many of the key points also just to disclaim there's many many other and better resources to learn about neural networks so i would very much welcome those with a technical

understanding of neural networks and or some of the more applied computational or uh otherwise aspects of neural networks it would be awesome to have them on for the dot one and the dot two because it was not an area i was familiar with and so hope that i can

hear more from the authors in our coming weeks and others i'm daniel i'm a researcher in california and this will just be a solo dot zero which i guess hasn't happened in a while uh in the making of this here's some of the generated art prompts area 51 active inference area 51 neural network area 51 active inference ants area 51 active inference neural network

Just some interesting images coming out of stable diffusion.

So as to some big questions that the paper is addressing and that one might be interested in to come to the paper, how can artificial neural networks be understood as generic optimization processes?

And what is the correspondence between neural dynamics and modern statistical inference methods?

Other big questions are about the history and next steps of the enmeshment of natural intelligence, e.g.

neuroscience and artificial intelligence, as well as of course, whether to even play into this kind of distinction at all and have different integrated intelligence frameworks.

and one paper where any of the authors or anyone who has uh kind of resonated with this work is recent by zador at all 2022 towards next generation artificial intelligence catalyzing the neuro ai revolution and so this is a bunch of authors and so it's interesting just to quote in terms of what

some areas of discourse are saying right now which is neuroscience has long been an important driver of progress in artificial intelligence ai we propose that to accelerate progress in ai we must invest in fundamental research in neuro ai so that's one way to read some of the developments that are happening in the paper we'll discuss what does it mean to be particular but generic that's a phrase used in the paper so maybe that's kind of a jumping off point

then how can active inference help us understand the past present and future here of the interface with neural networks statistics and neural ai here's the abstract

This work considers a class of canonical neural networks comprising rate coding models where neural activity and plasticity minimize a common cost function and plasticity is modulated with a certain delay.

We show that such neural networks implicitly perform active inference and learning to minimize the risk associated with future outcomes.

Mathematical analyses demonstrate that this biological optimization can be cast as maximization of model evidence

or equivalently minimization of variational free energy under the well-known form of a partially observed Markov decision process model.

This equivalence indicates that the delayed modulation of Hebbian plasticity accompanied with adaptation of firing thresholds is a sufficient neuronal substrate to attain Bayes' optimal inference and control.

We corroborated this proposition using numerical analyses of Mayes' tasks.

This theory offers a universal characterization of canonical neural networks in terms of Bayesian belief updating and provides insight into the neuronal mechanisms underlying planning and adaptive behavioral control.

Here is the roadmap.

I'll be driving on the right side of the road.

There's an introduction and a table with a glossary of different expressions used.

Then there's the results sections, which has first an overview of equivalence between neural networks and variational Bayes, active inference formulated using a post-diction of past decisions, canonical neural networks perform active inference and numerical simulations.

So they work on the interface between neural networks and variational Bayesian methods and start with a more theoretical,

and mathematical background, and then eventually present some maze simulations that are in MATLAB.

Then there's a discussion, and then the methods section is following the discussion.

And it has the subsections generative model, variational free energy, inference and learning, neural networks, simulations, and data analysis.

And I think that I have kept to the right color codes consistently from here on forward.

The black quotes are the direct quotes from the paper.

Blue quotes are related to perception.

uh orange for action complete class theorems and neural networks together in purple and then red is commentary and then the highlighting for red is related to um the variational methods but it's kind of red ish

okay the papers canonical neural networks perform active inference by the authors uh listed previously it's in communications biology from 2022. and the key aims of the paper are laid out well in the first paragraph so that's in black and other colors and uh here the red is just kind of

Getting into initial conversation with the paper and connecting a little bit more to some previous streams before we go more into the specifics of the paper.

The sentient behavior of biological organisms is characterized by optimization.

Biological organisms recognize the state of their environment by optimizing internal representations of the external environmental dynamics generating sensory inputs.

So that's the sensory recognition model.

In addition, they optimize their behavior for adaptation to the environment, thereby increasing their probability of survival and reproduction.

So that is bringing the entire active and inactive population

control theory, formal theories of action, action selections, planning, and planning as inference.

All of these action-oriented pragmatic turn type ideas come into play when this action orange aspect is brought in.

And it is slash must be slash should be, et cetera, oriented towards survival and persistence.

Otherwise, we don't see that kind of thing for log over appropriate definitions for thing and log, etc.

And this few sentences that the paper begins with summarizes a common theme in Act-Inf, which is that there's basically two pathways towards proficiency in the niche.

There's changing the mind, which is the perceptual and learning, and then there's changing the world through action.

And that kind of integration of inference, cognitive inference, whether it's perceptual or learning or other, and action as enacted is part of the act-inf formulism and shared with other areas.

This biological self-organization is typically formulated as the minimization of cost functions wherein a gradient descent on a cost function furnishes neural dynamics and synaptic plasticity.

So they are working with a framework where the way that this perception action flow

is tractable computationally, either just for our current computers so that we can implement simulations and data fitting, or whether more fundamentally like this is the computational context of action, they're suggesting there's a way to think of it in terms of a cost function minimization.

also note like minimization maximization in a way they're interchangeable because there's just sometimes negative signs that can flip them so it's the same energy and fitness landscape that is being navigated whether you're minimizing to the bottom of the bowl and thinking of action selection that way and inference or whether you're climbing to the top of the hill gradient descent gradient ascent they're both kind of two sides of the same coin

Two fundamental issues remain to be established.

Namely, so this is what the paper is saying.

They're filling the gap in literature.

The characterization of the dynamics of an arbitrary neural network as a generic optimization process

and the correspondence between such neural dynamics and statistical inference found in applied mathematics and machine learning.

The present work addresses these issues by demonstrating that a class of canonical neural networks of rate-coding models is functioning as, and thus universally characterized in terms of, variational Bayesian inference under a particular but generic form of the generative model.

This is maybe the only slide that has resources from too far afield from the paper.

Well, almost, a few more.

It's just on neural networks.

The search on a very common search tool resulted in five plus million results for what are neural networks.

And the first one was three blue, one brown.

from 2017 which is just a nice YouTube video as they very often make with these beautiful renditions and it's a very great video and there's many many others a neural network is a network or circuit of biological neurons and that is variously purely computational and or biological

map territory stuff.

And they can be thought of as nodes and edges, which are the firing rates and the connections between the biological neurons being modeled as weights between nodes.

a positive weight reflects an excitatory connection while negative values mean inhibitory connections and here is data coming in and ending up activating different neurons in this final layer so this is kind of doing inference in a neural net work and then there's an action part okay

The paper says variational Bayesian inference offers a unified explanation for inference, learning prediction, decision making, and the evolution of biological form, which can be considered over multiple timescales.

So this returns to the earlier theme of like perception, action, and

Persistence Within and Among Generations.

And the citations that are provided here for this are Friston, Kilner, Harrison, 2006, and Friston, 2010.

Both very classic ACDINF slash FEP papers.

Just to show one figure from each.

Here's from...

the first citation with the winged snowflake, where if the snowflake ends up being somewhere that's too warm, that's not able for it to maintain the structure, then it melts, melts into a dew, et cetera.

And it must be acting as if in one way or another, it's staying above that phase boundary.

That's how it's statistically identified.

It's how it's,

ontogenetically identified, functionally identified.

And then here is one of the kind of path setting figures in the Princeton 2010 paper with a tree of many different areas to connect to and formalisms to represent as, including probabilistic neural coding, Bayesian brain,

optimal control and value learning these three and others can be really seen at play in this 2022 paper uh the kind of inference variational bayesian methods use rests upon a generative model that expresses a hypothesis about the generation of sensory input

Perception and behavior can then be read as optimizing the evidence for a generative model inherent in sensory exchanges for the environment.

And that's the integration of perception and action within a single imperative in terms of if only computation.

And that is described more on this slide, which one can pause and read, but the rest of the quotes are from the paper.

One key formalism that I had no familiarity with before this paper and associated readings and conversations with Ali was the complete class theorem.

So it would be great for anyone who's familiar with complete class theorem to

help a little bit here, but here's some interesting things that I came across.

Crucially, from the paper, as a corollary of the complete class theorem, citations 19 through 21, any neural network minimizing a cost function could be viewed as performing variational Bayesian inference under some prior beliefs.

here are the citations 19 through 21 from 1947 1981 2013 and uh also found some interesting resources so quoting from this less wrong post linked here

dutch book defines belief as willingness to bet and money pump defines preference as willingness to pay this is in terms of the foundational arguments for a bayesian epistemological

worldview hope that's correct again it'd be good to hear from anyone who knows more here but in terms of different ways that one can consider the Bayesian proposition which perhaps these are even better to use than referencing any person's last name because the interesting thing will be the different

lenses that these different framings on bayesian probabilities

are interpreted as just like what a p-value is interpreted as in the frequentist world kind of analogously like a bayes factor interpretation so dutch book defines belief as willingness to bet and money pump defines preference as willingness to pay in doing so both arguments put the justification of decision theory into hypothetical exploitation scenarios which are not quite the same as the actual decisions we face

If these were the best justifications for consequentialism we could muster, I would be somewhat dissatisfied, but would likely leave it alone.

Fortunately, a better alternative exists, the complete class theorem.

So here's an image from that post.

Possible world states observation likelihood maps to the possible observations.

Hashtag A matrix.

Then decision-making rule, maybe probabilistic.

Action selection as inference.

A, possible actions.

Affordances.

And here, we commonly see the loop being closed from actions to world states, like through the B matrix, changing how the world changes through time.

And here, these are both going to be mapped to a loss function, L, a real valued score from taking an action A when the world turned out to be theta, realized theta.

So that's quite an interesting framing.

And there were some other useful posts online.

And from this ZHAT blog, the argument boils down to, if you agree with expected utility as your objective, then you have to be Bayesian.

In a nutshell, a strategy is inadmissible if there exists another strategy that is as good in all situations and strictly better in at least one.

If you want your strategy to be admissible,

It should be equivalent to a Bayes estimator.

Complete class theorems.

Only Bayes strategies are admissible and admissible strategies are Bayes.

So there's probably a lot of interpretations of this, but it seems kind of related to optimal control or Bayes' optimal inference, perhaps a little bit more keenly.

So these are some next two slides were contributed by Ali.

So if you, or if anyone familiar in this area wants to come on the discussion to be, great.

But Ali pointed me to this book, Fundamentals of Bayesian Epistemology,

by Teitelbaum 2022 table of contents shown here and some challenges and objections to Bayesian epistemology are listed which can be read and then also there's some quite interesting logical structures which can be read here in terms of their premise theorem and conclusion

in the areas of arguments for bayesianism being representation theorem argument for probabilism the dutch book argument for probabilism and the gradational accuracy argument for probabilism so pretty interesting

Back to the paper.

They wrote, we have previously introduced a reverse engineering approach that identifies a class of biologically plausible cost functions for neural networks.

Citation 22.

Previous paper of Isomura and Friston, 2020.

The paper was reverse engineering neural networks to characterize their cost functions.

the abstract shown here, but this letter considers a class of biologically plausible cost functions for neural networks.

Using generative models based on partially observable Markov decision processes, POMDP, we show that neural activity and plasticity perform Bayesian inference and learning, respectively by maximizing model evidence.

So this is a precursor paper from 2020 that is cited and foundational for the 2022 paper.

Here's some figures from that paper.

They have comparisons among a Markov decision process scheme and a neural network.

For example, a Markov decision process scheme expressed as a Forney factor graph based on the formulation in Friston.

So here is the Markov decision process as a Forney factor graph, and on the right side is the neural network.

with the hidden state sensory inputs and neural activity and some figures and concordances.

And they wrote, in this context, the neural network can in principle be used as a dynamic causal model to estimate threshold constants and implicit priors.

This reverse engineering speaks to estimating the priors used by real neuronal systems under ideal Bayesian assumptions, sometimes referred to as meta-Bayesian inference.

So they're laying out their research agenda and they're

much of the work is going to reference this earlier paper and other work and then there's also some new integrations and especially the maze simulation in this paper and probably more so let's find out referring to the earlier paper

This foundational work identified a class of cost functions for single layer feedforward neural networks of rate coding models with a sigmoid or logistic activation function.

We subsequently demonstrated that mathematical equivalence between the class of cost functions for such neural networks and variational free energy under a particular form of the generative model, which is similar broadly to what the 22 paper does too.

This equivalence licenses variational Bayesian inference as a fundamental optimization process that underlies both the dynamics and function of such neural networks.

However, it remains to be established whether the active inference is an apt explanation for any given neural network that actively exchanges with its environment.

In this paper, we address this inactive or control aspect to complete the formal equivalence of neural network optimization and the free energy principle.

So this earlier work was not including action.

And so this paper's key addition, as I understand it, hopefully, is that they bring action more formally into the model

And it'd be interesting to know what else is that change associated with or what else happens or doesn't.

Here's some more text about the approach that they're going to take.

And many of these details are going to be addressed later on.

Here's table one glossary of expressions.

So these will also be broadly addressed later on.

Maybe it's useful though, just to read the first one, a canonical neural network.

In this work, the canonical neural network is defined by differential equations of neural activity derived as a reduction of realistic neuron models through some approximations, which give a network of rate coding neurons with a sigmoid activation function.

In particular, we consider networks comprising a middle layer that involves recurrent connections

the output layer that provides feedback responses to the environment so some category of neural network architectures or anatomies physiologies whatever with sensory cognitive and action-like features in an environment or a generative process so the results section

They write, in overview of equivalence between neural networks and variational base.

First, we summarize the formal correspondence between neural networks and variational base.

A biological agent is formulated here as an autonomous system comprising a network of rate coding neurons, figure 1a.

So here's a small figure 1a, we'll see it larger.

based upon the assumptions which will be brought up later on in a different fuller form the update rule for the ith component of phi which is the internal states so the cognitive states and the output layer y so middle layer x and output layer y

These can be seen as the cognitive and the action selective aspects, which are the autonomous states in contrast to the particular states of the active inference entity, which is the whole blanket and the cognitive states.

So including the sensory states, but the sensory states can't be directly controlled.

However, action can influence them.

And so that's what closes the causal loop.

And that set of the particular states comprising the autonomous states, the update rule for the ith component of phi is derived as the gradient descent on the cost function.

So the change in that, bi sub i, is proportional to a derivative on the loss function.

This determines the dynamics of neural networks, including their activity and plasticity.

So L, common loss function.

O, observations, sensory states.

Bi, internal states comprising the middle and output layer, neural activity, that's the rate coding part, and synaptic strengths, W, the parameterization.

and other free parameters, including that, that characterize L. Then there's the output layer activity.

Y is determining the network's actions or decisions.

Delta.

O, X, and Y. Y is the outputting action, environment, generative process, hidden state, passing observations to the sensory, cognitive, active layers of the neural network.

And that is analogous

topologically to the variational Bayesian formulation in Figure 1b.

And so, left side, gradient descent on a neural network cost function L determines the dynamics of neural activity and plasticity.

Thus, L is sufficient to characterize the neural network.

And then, being shown next to, on the right side, variational free energy minimization allows an agent to self-organize

to encode the hidden states of the external milieu and to make decisions minimizing future risk.

Here, variational free energy F is sufficient to characterize the inferences and behaviors of the agent.

So, sentence structure, parallelism, and these two schemes or approaches being linked and applied is a focus of this area.

So neural networks are minimizing the cost function L. In contrast, variational Bayesian inference depicts a process of updating the prior distribution of external states, p of theta, to the corresponding posterior distribution, q of theta, based upon a sequence of observations.

And we see other familiar terms from discussions on variational Bayes, like minimization of surprise,

And there's some more model details shown here.

A few points are about choosing the family of distributions that one is doing variational inference with.

And that allows for the gradient update rules in that family of distributions to be made simpler.

for example, choosing a linear regression with an L2 norm, at the very least, you can say that it has a simple decision rule for being fit.

I'm sure there's like also counter arguments and other algorithms that are better and so on.

But just to say that a simple decision rule in a known family of distributions can often be good enough as an approximation, if not more.

Crucially, according to the complete class theorem,

from earlier, a dynamical system that minimizes its cost function can be viewed as performing Bayesian inference under some generative model and prior beliefs.

The complete class theorem, just goes on to describe it, ensures the presence of a generative model that formally corresponds to the above defined neural network characterized by L. Hence, this speaks to the equivalence between the class of neural network cost functions and variational free energy under such a generative model.

Equation one,

loss function on the time series of observations comma parameters three lines is defined as f the free energy function on the same o through time comma parameters so there's a

parallel being shown slash defined, wherein the internal states of a network phi encode or parameterize the posterior expectation theta.

This mathematical equivalence means that an arbitrary neural network in the class under consideration is implicitly performing active inference through variational free energy minimization,

And more is written, but this is one of many statements that will be made corresponding to correspondences between neural network loss function, generative model, act-inf, free energy minimization, and associated formalisms.

Note that being able to characterize the neural network in terms of maximizing model evidence lends it in explainability,

in the sense that internal neural network states and parameters encode Bayesian beliefs or expectations about the causes of observations.

In other words, the generative model explains how outcomes were generated.

However, the complete class theorem does not specify the form of a generative model for any given neural network.

To address this issue, in the remainder of the paper, we formulate active inference using a particular form of partially observable Markov decision processes, POMDP models, whose states take binary values.

So this is one of several simplifications, is one way to see it, or areas for later generalization.

Figure 2.

In this section, we define a generative model and ensuing variational free energy that corresponds to a class of canonical neural networks that will be considered in the subsequent section.

The external milieu is expressed as a discrete state space in the form of a POMDP.

Figure 2.

So to make figure 2 larger.

There's a lot to probably say about this figure.

I'll just note that the caption is informative and some of the highlighted lines.

It'll be awesome to have the author and other people who's familiar with some of the differences and symmetries between the, for example, bottom and top.

above and below the observations and also about the role of time and what these two risks are what is fictive causality here's more details on that pomdp

Then equation two.

This is in the section active inference formulated using a postdiction of past decisions.

So if it was a prediction of future decisions, it's the opposite, a postdiction of past decisions.

Hence, we define the generative model as follows.

P O delta S gamma theta, which is the model of observations, decisions,

observations, decisions, hidden states, risk, and theta.

Theta equals A, B, and C. Constitutes the set of parameters and more details are provided.

This is the familiar notation with some slight differences that'll be described.

And equation two reflects the factorizability

and the dimensions and the kind of computational tractability expression so that would be interesting to also learn about like under what conditions can this joint distribution be factorized under what simplifications or constructions

The agent is making decisions to minimize a risk function, capital Gamma.

That's on the bottom of figure two.

Fictive causality leading to this Gamma coming from that Gamma.

Equation three is shown, and to characterize the optimal decisions as minimizing expected risk in our POMDP model, we use a fictive mapping from the current risk gamma to pass decisions.

That's that retrodictive fictive causality.

Although this is not the true causality in the real generative process that generates sensory data, here we intend to model the manner that an agent subjectively evaluates its previous decisions after experiencing their consequences.

This fictive causality is expressed in the form of a categorical distribution.

So it could be other families, hypothetically.

But this equation three is describing fictive causality and this interesting sign.

indicates the element-wise division operator.

Also note throughout the manuscript, the overlying variable indicates 1 minus that variable.

So gamma bar equals 1 minus gamma, or it can be understood as the complement of a statistical probability.

Probability of A happening and the probability of not A happening in that one way.

Importantly, the agent needs to keep selecting good decisions while avoiding bad decisions.

To this end, equation 3 supposes that the agent learns from the failure of decisions by assuming that the bad decisions were sampled from the opposite of the optimal policy mapping.

Some more details.

And then, by convention,

Active inference uses C to denote the prior preference.

That's how we've seen the C variable in many models as preferences, prior preference.

This work uses C to denote a mapping to determine a decision depending on the previous state.

Herein, the prior preference is implicit in the risk function.

Due to construction, C

does not explicitly appear in the inference.

Thus, it is omitted in the following formulations.

So that's a key point about the notation of the variable C and something kind of maybe interesting to explore.

Equation 4, variational Bayesian inference refers to the process that optimizes the posterior belief Q of theta.

Based on the mean field approximation, Q of theta is expressed as, and here is the

factorization representation of the Q of theta, variational.

And another notation note.

Throughout the manuscript, bold case variables, such as bold s sub tau, denote the posterior expectations of the corresponding italic case random variables.

And some more details about the model.

For example, for simplicity, here we suppose that state and decision priors D and E are fixed.

So one could imagine they don't have to be, but for simplicity, they will be here.

Under the above defined generative model and posterior beliefs, the ensuing variational free energy is analytically expressed as follows.

Equation five.

This is a variational free energy, F, and recall equation one, that it is being connected to, juxtaposed with, et cetera, the loss function.

The gradient descent on variational free energy

updates the posterior beliefs about hidden states, S, decisions, delta, and parameters theta.

The optimal posterior beliefs that minimize variational free energy are obtained as the fixed point of the implicit gradient descent, which ensures that change in F with respect to the change in hidden state through time equals zero and some more definitions.

All of them are zero.

That one might be an O, but they're all zero.

and this is saying the ball rolls to the bottom of the hill in this gradient descent and when the rate of change is zero then that is a fixed point attractor like dynamic and that can be used as a way to incrementally fit statistical models like the loss function is used to incrementally fit neural networks

To explicitly demonstrate the formal correspondence with the cost function for neural networks, consider in the next section we further transform the variational free energy as follows.

Some details.

Using these relationships, equation five is transformed into the form shown in figure three.

See the method section variational free energy for further details.

In what follows, we demonstrate that the internal states of canonical neural networks encode posterior beliefs.

Here's figure three.

On the top from the caption figure three is the mathematical mathematical equivalence between variational free energy and neural network cost functions depicted by one to one correspondence of their components top variational free energy transformed from equation five using the Bayes theorem.

and

foreshadowing equation seven.

Using this relationship, equation seven is transformed into the form presented at the bottom of the figure.

So here's F, variational free energy, and L, the neural network cost function, and different elements as they're represented here

with some resonances and concordance and beyond which we can explore they're being shown to be equivalent and it was in the conversation preparing for this dot zero with dean where we saw this as some chromosomes

In this section, canonical neural networks perform active inference.

In this section, we identify the neuronal substrates that correspond to components of the active inference scheme defined above.

We consider a class of two-layer neural networks with recurrent connections in the middle layer, Figure 1a.

Those are those connections with loops recurrent in the middle layer.

The modeling of the networks in this section, referred to as canonical neural networks, is based on the following three assumptions that reflect physiological knowledge.

1.

Gradient descent on a cost function L determines the updates of neural activity and synaptic weights.

Method section, neural networks.

Assumption 2.

Neural activity is updated by the weighted sum of inputs and its fixed point is expressed in a form of the sigmoid or logistic function.

Assumption 3.

A modulatory factor mediates synaptic plasticity in a post hoc manner.

They write, based upon assumption two, which is neural activity is updated by the weighted sum of inputs and its fixed point, is expressed in the form of a sigmoid or logistic function.

Based on assumption two, we formulate neural activity in the middle layer and output layer, the autonomous states, as follows.

Equation six.

Without loss of generality,

Equation six can be cast as the gradient descent on cost function L. Such a cost function can be identified by simply integrating the right-hand side of equation six with respect to X and Y consistent with previous treatments, citations.

Because neural activity and synaptic plasticity minimize the same cost function L, the derivatives of L must generate the modulated synaptic plasticity.

Under these constraints, reflecting assumptions one through three, a class of cost functions is identified as follows.

Equation seven, loss function.

Awesome to hear somebody read this directly.

So there's a firing rate aspect.

that's related to neural firing in the short term, more perceptual aspect of function.

And there's a slower neurotransmitter, neuroglial factor mediated learning over perhaps a different timescale and with some different features.

And they're being included as a joint model of inference.

And here that is being connected to doing inference on action.

synaptic plasticity in neural networks so synaptic plasticity rules conjugate to the above rate coding model can now be expressed as a gradient descent on the same cost function l according to assumption one equations eight and nine showing that neural networks can integrate those modes of firing rate like and synaptomodulatory like

neural networks, cost functions, and variational free energy.

Based on the above considerations, we now establish the formal correspondence between the neural network cost function and variational free energy.

Using under the aforementioned three minimal assumptions, we identified the neural network cost function as equation seven.

Equation seven can be transformed into the form shown in figure three bottom using sigmoid functions of synaptic strengths.

So equation seven, loss function,

transformed into the form shown in Figure 3.

Bottom.

Hence,

Hence, this class of cost functions for canonical neural networks is formally homologous to variational free energy under the particular form of the POMDP generative model defined in the previous section.

We obtained this result based on analytic derivations without reference to the complete class theorem, thereby confirming the proposition of equation one, loss function and free energy.

This in turn suggests that any canonical neural network in this class is implicitly performing active inference.

Table 2 summarizes the correspondence between the quantities of the neural network and their homologues in variational base.

So 2

a great concordance table on the left side neural network formation on the right side variational bayes formulation so just like in figure three we had the two long lines then table two we have rotated 90 degrees

and the variables for different parts of these models are laid next to each other so what papers of neural networks can we make active models for is it already done or is there just one

script that needs to be done and then conversely what interesting variational bayesian models have interesting applications or some other value or information gain from being cast as neural networks or integrating neural networks into what had previously been

only analytical variational Bayesian models as well as the empirical data fitting aspect which is related that's highlighted by the authors

So in summary, when a neural network minimizes the cost function with respect to its activity and plasticity, the network self-organizes to furnish responses that minimize the risk implicit in the cost function.

This biological optimization is identical to variational free energy minimization under a particular form of the POMDP model.

Hence, this equivalence indicates that minimizing the expected risk through variational free energy minimization is an inherent property of canonical neural networks featuring delayed modulation of Hebbian plasticity.

okay brief second to view some image memes and take a breath and a stretch on the left side the top panel says every neural network is implicitly performing active inference question mark that's awesome

In the middle image meme, one simply makes a neural network and it is implicitly performing active inference.

Also question mark.

And then in the right image meme, there are two pieces of paper, neural network and implicit performance of active inference.

Corporate needs you to find the differences between this picture and this picture.

And here is the paper.

They're the same picture.

So the previous sections have successfully extended the variational Bayes meets inference neural network results from the 2020 paper with an action loop and a loss function only on the autonomous states.

So that was the conceptual and technical

feature that this paper brought in again it'll be awesome to hear the author describe it more and differently and then in this part of this of the paper they turn from that kind of analytical theoretical towards some numerical simulations in MATLAB

Here we demonstrate the performance of canonical neural networks using maze tasks as an example of a delayed reward task.

The agent comprised the aforementioned canonical neural networks

figure 4a thus it implicitly performs active inference by minimizing variational free energy so now some entity or agent is going to be constructed and numerically simulated to support some of the uh

aspects of their model and point towards utility in other settings so here's figure four simulation of neural networks solving maze tasks uh in part a there is the architecture of the agent sensory input layer o of t synaptic weights into the middle layer x internal states

and the output layer Y, decision action with risk gamma of T. The sensation comes in, a neural network, then outputs a decision.

There's some task that the entity must perform, which is

to move towards the goal from the start across this lateral maze.

So one could imagine that if it were just a hallway with no maze features, simple strategies would be very overfit, but effective, like always move simply towards the goal.

Whereas in more complex settings, which this is an example of, where there's uncertainty as well as many local optima.

So one has to sometimes take one or two or three or four or more steps or however many to get closer to the goal.

and sometimes may not know, for example, how long those backtracking situations are going to be and all these other complexities for which this maze example is symbolic of.

So maybe there's some interesting mythos maze connections and computational.

And here's some performance measures on the maze task with the neural network entity this way.

Before training, the agent moved to a random direction in each step, resulting in a failure to reach the goal position within the time limit.

During training, the neural network updated synaptic strengths depending on its neural activity and ensuing outcomes .

This training comprised a cycle of action and learning phases.

This treatment renders neural activity and adaptive behaviors of the agent highly explainable and manipulatable in terms of the appropriate prior beliefs, implicit and firing thresholds for a given task or environment.

In other words, these results suggest that firing thresholds are the neuronal substrates that encode state and decision priors as predicted mathematically.

Big if true.

Furthermore, when the updating of parameters is slow across these two now linked domains, parameters of the variational Bayesian autonomous state inference and the neural network loss function parameters, when the updating of these parameters are slow in relation to the experimental observations,

The parameters can be estimated through Bayesian inference based on empirically observed neuronal responses.

See method section data analysis for details.

Using this approach, we estimated implicit prior E, which is encoded by psi,

from sequences of neural activity generated from the synthetic neural networks used in the simulations reported in figure four.

We confirmed that this estimator was a good approximation to the true E. So that's also pretty interesting.

This is showing they don't just lay out this architecture and show that it's possible to fulfill this maze task with the best

whatever it's not a classification accuracy imperative alone they're describing that from empirically observed neuronal responses which is to say the experimenter's observation the sequences of neural activity generated from the synthetic neural networks used in that figure

Numerically, so statistically, that estimator was a good approximation to the true E, figure 5A.

So here's figure 5.

Estimation of implicit priors enables the prediction of subsequent learning.

So that's pretty interesting and will be great to hear what each of the axes are and what all the variables mean.

With this setup in place, they did some numerical validation and talked a little bit more about fitting data from this simulation model.

Here's the discussion section.

So the first paragraph of the discussion.

Biological organisms formulate plans to minimize future risks.

In this work, we captured this characteristic in biologically plausible terms under minimal assumptions.

We derive simple differential equations that can be plausibly interpreted in terms of a neural network architecture that entails degrees of freedom with respect to certain free parameters, e.g.

firing threshold.

These three parameters play the role of prior beliefs in variational Bayesian formulation.

Thus, the accuracies of inferences and decisions depend upon prior beliefs, implicit in neural networks.

And here's some more stable diffusion.

Ant neural network, ant brain neural network.

So some more summarization of what they did.

Based on the view of the brain as an agent that performs Bayesian inference, neuronal implementations of Bayesian belief updating have been proposed, which enables neural networks to store and recall spiking sequences, eight, learn temporal dynamics and causal hierarchy, nine,

extract hidden causes 10, solve maze tasks 11, and make plans to control robots 12.

So citations 8 through 12 listed here.

In these approaches, the update rules are generally derived from Bayesian cost functions, e.g.

variational free energy.

However, the precise relationship between these update rules and the neural activity and plasticity of canonical neural networks has yet to be fully established.

We identified a one-to-one correspondence between neural network architecture and a specific POMDP implicit in that network.

Equation 2 speaks to a unique POMDP model consistent with the neural network architecture defined in equation 6.

where their correspondences are summarized in table two and the figures.

This means that our scheme can be used to identify the form of the POMDP given an observable circuit structure.

Moreover, the free parameters that parameterize equation six can be estimated using equation 24.

This means that the generative model and ensuing variational free energy can in principle be reconstructed from empirical data.

This offers a formal characterization of implicit Bayesian models entailed by neural circuits, thereby enabling a prediction of subsequent learning.

So what can be done with this?

What is this new?

What is new here?

Does this second selection

fully establish the precise relationship between these update rules and the neural activity and plasticity of canonical neural networks.

Here is a discussion section on Hebbian plasticity, neurotransmitters, and glia, with a lot of citations listed.

And here is just one interesting follow-on discussion from the computational aspects, neurocognitive and computational aspects of Hebbian plasticity, is these modulations have been observed empirically with various neuromodulators and neurotransmitters, such as dopamine,

noradrenaline, muscarine, and GABA, as well as glial factors.

So here's a picture by Alexandra Mikhailova.

Cultured astrocytes release signaling and growth factors that regulate proper neuronal development.

So cool glial pic.

Dopamine and reinforcement learning.

In particular, a delayed modulation of synaptic plasticity is well known with dopamine neurons.

Citations 35 through 37.

Those citations are listed here.

This speaks to a learning scheme that is conceptually distinct from standard reinforcement learning algorithms, such as the temporal difference learning with actor-critic models based on state action value functions.

Please see the previous work, citation 50,

for a detailed comparison between active inference and reinforcement learning.

That is Sajid, Bal, Par, and Fristen, active inference, demystified, and compared from 2021.

And that's also ACTIV model stream number 2.1.

We mathematically demonstrated that such plasticity enhances the association between the pre-post mapping and the future value of the modulatory factor, where the latter is cast as a risk function.

This means that postsynaptic neurons self-organize to react in a manner that minimizes future risk.

So the neural network had three layers.

It's the second and the third layer, not the initial sensory layer, but the second and the third layer, the cognitive and the active states, which are the autonomous states of the particular states.

So that's quite interesting.

The self-organization of postsynaptic neurons

to react in a manner that minimizes future risk?

Crucially, this computation corresponds formally to variational Bayesian inference under a particular form of POMDP generative models, suggesting that the delayed modulation of Hebbian plasticity is a realization of active inference.

And regionally specific projections of neuromodulators may allow each brain region to optimize activity to minimize risk and leverage a hierarchical generative model implicit in cortical and subcortical hierarchies.

This is reminiscent of theories of neuromodulation and meta-learning developed previously.

Citation 52.

Doya, 2002.

Meta-learning and neuromodulation.

Cool.

Our work may be potentially useful when casting these theories in terms of generative models and variational free energy minimization.

They then return the discussion to the complete class theorem and neural networks.

So the complete class theorem, same citations from before, ensures that any neural network whose activity and plasticity minimize the same cost function can be cast as performing Bayesian inference.

however identifying the implicit generative model that underwrites any canonical neural network is a more delicate problem because the theorem does not specify a form of the generative model for a given canonical neural network which is pretty interesting is that to say that the form of the generative model as modeled is different in what ways from the given canonical neural network

The posterior beliefs are largely shaped by prior beliefs, making it challenging to identify the generative model by simply observing systemic dynamics.

To this end, it is necessary to commit to a particular form of the generative model and elucidate how posterior beliefs are encoded or parameterized by the neural network states.

This work addresses these issues by establishing a reverse engineering approach to identify a generative model implicit in a canonical neural network, thereby establishing one-to-one correspondences between their components.

Remarkably, a network of rate coding models with sigmoid activation function formally corresponds to a class of POMDP models, which provide an analytically tractable example of the present equivalence.

Please refer to the previous paper, Cytation 22, for further discussion.

So some of the analytical details, especially on the inferential side, cognitive side,

burr captured in the earlier paper this paper goes further into mapping the

potentially necessary and sufficient aspects of the particular entity which is to say the risk minimizing features of the autonomous states with respect to the entire particular states including sensory states connecting that back of the envelope verbally expressible formulation to

some complete class of neural networks.

So what's outside of the complete class and why, and then what groups within the class have special or different features.

It is remarkable that the proposed equivalence can be leveraged to identify a generative model that an arbitrary neural network implicitly employs.

This contrasts with naive neural network models that address only the dynamics of neural activity and plasticity.

If the generative model differs from the true generative process that generates the sensory input, inferences and decisions are biased relative to Bayes' optimal inferences and decisions based upon the right sort of prior beliefs.

In general, the implicit priors may or may not be equal to the true priors.

Thus, a generic neural network is typically suboptimal.

Nevertheless, these implicit priors can be optimized by updating free parameters e.g.

threshold factors,

by psi, based on the gradient descent on cost function L. By updating the free parameters, the network will eventually, in principle, become Bayes optimal for any given task.

In essence, when the cost function is minimized with respect to neural activity, synaptic strengths and any other constants that characterize the cost function

the cost function becomes equivalent to variational free energy with the optimal prior beliefs.

So the cost function for the neural network activity and synaptic strengths underlying the loss function

are equivalent to the kind of gradient descent enabled variational free energy minimization under the base optimality scenario from a risk perspective

Simultaneously, the expected risk is minimized because variational free energy is minimized only when the precision of the risk, gamma, is maximized.

See method section generative model for further details.

Very interesting.

They then say...

The class of neural networks we consider can be viewed as a class of reservoir networks.

Citation 54, citation 55, here.

The proposed equivalence could render such reservoir networks explainable.

and may provide the optimal plasticity rules for these networks to minimize future risk by using the formal analogy to variational free energy minimization under the particular form of POMDP models.

A clear interpretation of reservoir networks remains an important open issue in computational neuroscience and machine learning.

So from Wikipedia, reservoir computing is a framework for computation derived from recurrent neural network theory that maps input signals into higher dimensional computational spaces through the dynamics of a fixed nonlinear system called a reservoir.

After the input signal is fed into the reservoir, which is treated as a black box, a simple readout mechanism is trained to read the state of the reservoir and map it to the desired output.

Then there's two key benefits of this approach.

the first key benefit of this framework is that training is performed only at the readout stage as the reservoir dynamics are fixed the second is that the computational power of naturally available systems both classical and quantum mechanical can be used to reduce the effective computational cost here's some stable diffusion reservoir computing active inference neural network

So this would be interesting to discuss, and I remember some Act-Inf Institute participants who are specifically interested.

Empirical analyses and hypotheses.

They write, the equivalence between neural network dynamics and gradient flows on variational free energy is empirically testable using electrophysiological recordings or functional imaging of brain activity.

So, then another summarization.

Crucially, the proposed equivalence guarantees that an arbitrary neural network that minimizes its cost function, possibly implemented in biological organisms or neuromorphic hardware, can be cast as performing variational Bayesian inference.

So, to state it a few more times in the final paragraph.

In summary, a class of biologically plausible cost functions for canonical neural networks can be cast as variational free energy.

Formal correspondences exist between priors, posteriors, and cost functions.

This means that canonical neural networks that optimize their cost functions implicitly perform active inference.

This approach enables identification of the implicit generative model and reconstruction of variational free energy that neural networks employ.

This means that in principle,

Neural activity, behavior, and learning through plasticity can be predicted under Bayes' optimality assumptions.

There's a code availability statement.

The MATLAB scripts are available at GitHub in the repo of the first author, and it would be awesome

the author or anyone to bring this working matlab script up and see if we could do some real-time active inference then as mentioned earlier from the roadmap the methods are following the discussion

i'll just show the equations but not go into any details because there's not time nor familiarity so those who have more of one or the other would be welcome to fill in some dots because this is a really awesome and important paper so i hope that it can be

interpreted and critiqued and elaborated on and so on by those with familiarity in both sides of that free energy loss function equation one

Generative model section.

Many details are provided.

Equation 10 is shown.

It's a larger unpacking of the generative model.

Section variational free energy.

Many details are provided.

Equation 11, 12, 13, 14, and 15.

Section inference and learning.

Details are provided.

Equations 16, 17, 18.

Then section on neural networks.

So there was just some interesting writing here.

So I wanted to highlight that.

In this section, we elaborate the one-to-one correspondences between components of the canonical neural networks and variational bays via an analytically tractable model.

So that's the figure three that we've been returning to.

Neurons respond quickly to a continuous stimulus stream with a timescale faster than typical changes in sensory input.

For instance, a peak of spiking neurons in the visual cortex of V1 appears within 50 and 80 milliseconds after a visual stimulation.

Citation 62-63.

which is substantially faster than the temporal autocorrelation timescale of natural image sequences, about 500 milliseconds, citation 6465.

So that's pretty interesting.

What is the temporal autocorrelation timescale of natural sequences?

What timescale do neural firing and neuroplasticity, etc.

processes actually occur at?

and when might some type of function at a given time scale be understood to be functional or not thus in other words downstream of the fact that neurons respond quickly

at a time scale faster than typical changes in sensory input, we consider the case where the neural activity converges to a fixed point given a sensory stimulus.

We note that the present equivalence is derived from the differential equations, equation six, but not from its fixed point.

Thus, the equivalence holds true irrespective of the time constant of neurons.

To rephrase, neural networks with a large time constant

formally correspond to Bayesian belief updating with a large time constant, which implies an insufficient coverage of the posterior beliefs.

Pretty interesting related to learning rates and Bayesian updating rates and all of the nooks and crannies of Bayesian inference and the challenges associated with dynamic, uncertain, rugged, fitness, and free energy landscapes.

these optimization challenges, which are addressed differently methodologically, culturally, et cetera, in the variational Bayesian and in the neural cases,

they have to deal with time and so all of those different nooks and crannies mentioned like catastrophic learning catastrophic forgetting simply memory anticipation attention local maxima choosing when to play all these higher order questions

are connected here does that make it what kind of a problem space now or just what kind of space pretty interesting and equation 19 20 21 22 23. they have some more details on the simulation

Maybe we could see the simulation go.

And in the last section, data analysis.

So this is kind of returning to that point about the time constants in Bayesian and neural network systems.

When the belief updating of implicit priors, D and E, is slow in relation to experimental observations...

D and E, which are encoded by phi and psi, can be viewed as being fixed over a short period of time, as an analogy to homeostatic plasticity over longer timescales, 66.

Homeostatic plasticity in the developing nervous system, 2004.

Very interesting in light of our recent discussions on allostasis and other topics.

Thus,

Phi and Psi can be statistically estimated by a conventional Bayesian inference or maximum likelihood estimation given a flat prior based on empirically observed neuronal responses.

In this case, the estimators of Phi and Psi are obtained as follows.

Nice equation number 24 mentioned earlier.

So that will be definitely one to look into more.

Well,

I hope you found this a useful and interesting .zero.

I'm looking forward to the discussion with the author and again any other Institute participants or those with knowledge or strong feelings to express about neural networks active inference applied active inference computational modeling of perception cognition and action

neural networks in the wild, AI ethics, all these different areas can hopefully have a nice discussion in 51.1 and 51.2.

That'll be the last paper streams for 2022.

There will still be a few guest streams upcoming.

So those discussions will close the paper

focused prepared live streams for 2022 and yeah if you want to be more involved with live streams whenever you're listening to this join or recommend someone to join or help in any number of other ways

Just listening and learning is awesome.

And we also really look forward to those who want to help make some of these connections that are latent and sometimes exposed in these papers and conversations.

and with a few motivated people who want to connect for example to the neural network communities and those who can facilitate discussions on these topics that would be awesome just using my final thoughts on this dot zero

because it's always great to have others also join in the preparation for the dot zero so just want to add that note on this rare solo stream so thanks again looking forward to talking or seeing you later bye