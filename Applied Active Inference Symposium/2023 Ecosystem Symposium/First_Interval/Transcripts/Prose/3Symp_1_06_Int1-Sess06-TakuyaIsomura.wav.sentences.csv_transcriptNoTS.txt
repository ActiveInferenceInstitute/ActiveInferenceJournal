
Daniel:
All right.
Greetings, Takuya.

Takuya:
Hi.

Daniel:
You can mute the live stream or turn off the other live stream, but yeah, thank you for joining.

Takuya:
Yes, thank you for inviting thank you for it. Yeah, it.

Daniel:
Well, we have a little bit 35 or 38 minutes, so it would be awesome to have your presentation.

Takuya:
Great. So the moment well, can you see my.

Daniel:
I saw PowerPoint.

Takuya:
Okay.
Can you see my screen?

Daniel:
Perfect.

Takuya:
Okay. So shall we start?

Daniel:
Yes.
Thank you.

Takuya:
Then. Thank you for organizing this wonderful symposium. Today I'd like to talk about relationship between canonical neural network and active inference and possible extension for modeling social and shared intelligence using canonical neural network. So let's start.
As you know, the free energy principle is proposed by Karl Friston that states that perception, learning and action of all biological organisms are determined to minimize variational free energy as a tractable proxy for surprise minimization. And by this process organism can perform parational BJ inference or external mineral state. And this can't even just show one example typical set up under the free energy principle active inference. Here there is a hidden state in the external world and only a part of this state can be observable. For our agent, this doc and this transformation is done by genetic model parameterized by theta and to infer the hidden state, agent need to reconstruct the copy of the external state called posterior relief.
And this optimization is done by minimizing variational free energy. And parameter is also optimized by minimizing free energy to obtain an apt generative model to represent this relationship. An interesting aspect of the free energy principle active inference is its application to the optimization of action. Here our agent have some preference prior c and to obtain this observation in the future, agent may select the action that minimize the expected free energy in the future to obtain the most predictable outcome. And finally, by selecting actions that minimize the expect frequency, it can obtain the feed.
So, this is a typical setup under active inference. But question is what is the neural neurosurge that can implement this process? So that is our interest and to address this issue we propose theory as follows. Here we consider that external world is parameterized characterized by a set of the variables like this here, this is a posterior expectation and the S indicates the hidden state in the external world. Delta indicate the action of the agent or decision and the theta indicate a parameter and lambda is a hyperparameter.
So those set of parameters or variables characterize a generative model and free energy variational. Free energy is defined as a function of the sequence of observation and external state and its minimization indicates the variational Bayesian inference. Similarly, we consider a dynamics of neural network and we consider that dynamics is characterized by a set of those variables. Here x indicates the neuroactivity firing rate at middle raya neurons and y indicate neuroactivity of output raya neurons and W here is a synaptic weight and phi is any other free parameter that characterize neural network. And we consider that neural network dynamics is characterized by minimization of some cost function l.
This is a function of the O and Phi internal state of neural network and its minimization indicates the generation of neural network dynamics including both activity and plasticity. And our theory indicates equivalence between those two functions. Meaning that for any neural network that minimize some cost function error, there is a generative model that satisfy if we call error. Which means that the recapturation of external dynamics is an inherent feature of any neural system that follow such dynamics. So this is an interesting prediction but too abstract.
So I would like to introduce some analytically tractable example to understand this relationship formally. So first we consider a very simple architecture. This is represented by POMDP without any state transition. So hidden state s is simply generated by priya distribution D and it is a binary state. But we consider a vector of binary state, so it is a factory of structure and observation is also a binary vector and the transformation from S to O is characterized by categorical distribution using likelihood of matrix A and variational Bayesian inference indicates the inversion of this generative process like this.
So by solving the appropriate frequency functional we obtain those posterior brief that is optimal in the Bayesian sense. On the other hand, for neural network we consider such structure here upper part indicates the generation of signal in the external world and the neural network comprises only single layer. Here activity of output layer are generated by weighted sum of sensory input O weighted by synaptic matrix W. And we then characterize this neural network in the next slide. So to model neural network or neuron, we start from considering hodgeken hacksray equation which comprises four differential equation and this is a very complicated non linear equation although it is barely possible.
So we consider some reduction of these equations. So a typical reduction method is like this for example, m here is much faster than other variables so this can be repressed with its fixed point or it is known that h and minus one sorry, it is known that h and one minus SN have similar dynamics. So we can consider a new effective variable U to characterize those two variables and then we obtain 2D hoskin hacks ray equation like this. So this is a famous cross of neural network model which includes the well known Fitzfuel Nagamo model or other continuous neural network model and we modify those model to derive canonical neural model. So this is a definition of canonical neural network model.
Here leak current is characterized by imbass sigmoid function instead of cubic function which is adopted in the Fitzfuel Nagmo model. And we also consider connection synaptic connection and this part indicates synaptic input from sensory layer through weight matrices and 1 may consider that W one indicate excitatory synapse and W zero indicate inhibitory synapse and the threshold are adaptive thresholds that are function of W one and W zero. Interestingly, when we consider a fixed point of this differential equation we obtain well known red coding model with the Sigmoidal activation function. Which means that we can say that in some sense this canonical neural network network model is approximation of Hodgkin hatt's ray equation and its approximation level is, in some sense between the realistic model and the most simplified red coding model. So we basically consider this type of neural network model and in the next slide we consider what is the plausible cost function for this neural network model.
So again we write the same equation for canonical neural network model which represents the activity of neurons vector of neurons and we consider cost function for this differential equation which can be obtained by simply calculating the integral of right hand side of this equation and get this type of cost function for neural network. This is biologically plausible cost function in the sense that its derivative derived neural network activity which has a certain biological plausibility. Moreover, if we consider derivative of this cost function with respect to synaptic weight W, we obtain a conventional synaptic plasticity rule which follows Hebian law. On the other hand, for Bayesian inference we first define generality model like the previous slide and we then derive variational free energy for given genetic model. So this variation of free energy is derived from the Pom DP model in the previous slide and its minimization indicates the Beijing inference and running.
So we found formal correspondences between component of those two cost functions like this. So this broke vector formally correspond to this Brock vector that represent a posterior expectation and this logarithm correspond to this logarithm and actually this a matrix can be represented as the broke matrix like this and its dot product correspond to this computation. And finally, this phi naturally correspond to this log d logo state prior. Which means that because the cost function are same, its derivative provides its derivative provides sorry. Because the cost function are formally equivalent, its derivative sorry.
It's a result of derivative also corresponding each other. Which means that for any neural activity equation in this form, there is a corresponding Bayesian inference equation. This is an equation that compute the posterior belief of the hidden state and this synaptic practice equation formally correspond to learning or parameter of genetic model. And moreover, by establishing this relationship we can consider the reverse engineering of the generality model from empirical data here this schematic summarize our approach to reverse engineer generative model and we first record the neural activity and assign the canonical neural network to explain this obtained data. And by computing the integral we obtained a cost function for this canonical network.
And by the mathematical equivalence we established, we can automatically identify genetic model and variational free energy that correspond to this neural network architecture. So interestingly, this is a Bayesian agent which is a kind of artificial intelligence. But importantly, this artificial intelligence is formally derived from empirical data. So we can say that this agent is biomimetic artificial intelligence that follow the free energy principle and then its derivative with respect to parameter posterior derived synaptic plastic algorithms that follow the free energy minimization and its time integral can predict the running process of original neural network data. Which means that if the frequency principle is correct, then this prediction should work, should work and should be able to predict the result of this neural neta without referencing to the data itself.
So our strategy is in summary, our strategy is that we reconstruct generative model only from the initial data, like initial data before running and then predict the running process or running curve that this neural system should follow by using the frequency principle and compare or examine whether this prediction is correct by comparing actual data after running and the prediction by the free energy principle. And if this prediction is correct, then it indicates the predictive validity of the free energy principle under setup considered. So we apply this strategy to the in vitro neural network. So here, this in vitro neural network are stimulated using the POMDP generative process defined in the previous slide. So there are two hidden sources that are binary signals and they are mixed to generate 32 sensory stimuli.
Those are also binary. And this is an overview of experiment by stimulating in vitro neurons they generate spiking response and those rhyme indicate a high density spiking response. So we observed that in some neuron the response specificity is so we found that for some neuron response was high to source one signal compared to source two signal. And if we see the transition of those neurons, we found that although we removed the offset at the first session to set those activities zero, but we see that those neuron self organized to respond high when source one is one, but those neurons response low level when the source one is zero. So which means that those neurons activity, those neurons response was consistent with our theoretical prediction that neuroactivity cell organized to encode the posterior expectation of healing state.
And we also found that some other group of neuron responds preferentially to source two but not to source one. So then we ask okay, then we found that posterior expectation is encoded by neuroactivity and the next question is about other neuronal substrate and we then ask if the prior brief about hidden state is effectively equal to the firing threshold of neural activity model, neural network model. So if the theory is correct, this correspondence should exist. To check this, we first simulated a Bayern agent and when we varied the PRI of the Bayesian agent, the inference was attenuated as I expected. And we found that when we buried the excitatory level of in vitro neural network by using the pharmacological manipulation.
We also found that the attenuation of inference which is consistent with our theoretical prediction that firing threshold encode prior belief or the hidden state. And next we consider whether the scientific plasticity followed the free energy principle by asking whether free energy principle can predict the qualitative self organization of a subsequent neural data. So here we model neural network like this, there are two ensemble neurons that encode source one and source two. And we first compute the effective synaptic weight of those networks using a conventional connection strength estimation approach and plot those synaptic weights on the landscape of theoretically computed free energy.
So this is a trajectory of empirically estimated synaptic weights effective sign optic connectivity and as predicted, those changes reduce the free energy. And here we computed this theoretically predicted free energy landscape only using the past ten sessions data. So that this indicates that indicates some prediction of the self organization. And for more explicit prediction, we then simulated neuroactivity and plasticity using green as a principle. Here the brighter color indicates the prediction of data without reference to activity data.
So those lines exactly follow this free energy gradient. And we found that this predicted trajectory is tightly correlated with this empirically estimated effective synaptic weights. And LR rate is like this. So it indicates that frequency principle can quantitatively predict the circumstance in this setup, so it indicates some predictive validity of the free energy principle under this setup. And then we also consider the modeling of the neuromodulation using active inference.
It is well known that synaptic process is modified by various factors like Dopamine, northern adrenaline, acetylcholine, serotonin, so on. And one interesting property of those moderation is that even though Dopamine was added after associative plasticity was established, it can change the result of plasticity in a post hoc or restorespective manner, so it implies some association to the reward and past decisions. So we model this process using canonical neural network. So here we model the post hoc modulation of HEBM plasticity using this type of plasticity equation and we also consider the recurrent neural network structure and output layer for this network. And we consider that modulation occur at this connectivity layer.
And then we found cost function that can derive those differential equations and then found corresponding variational free energy and genetic model which means that this sort of neural network activity including moderation of sinus plasticity exactly follow the free energy principle under some type of homodp generative model. And by using this, we show that this biologically plausible neural network model with moderation of heavy and plasticity can solve some sort of delayed reward task like maze task. And then finally we would like to discuss a possible extension to this framework to the modeling social intelligence. So, to infer our con specifics, we need to select an appropriate generality model for our partners, depending on our partners. So this can be done by Beijing model selection scheme and we previously proposed a model that can predict the multiple biosomes using one big genetic model that comprises multiple genetic models.
And this movie shows prediction of prediction of songs. So like this, this model nicely identified which genetic model is the best to explain a given sensory input. And this process indicates and the model can correctly infer the appropriate model and then imitate the song by its own action. So, although in the previous work we didn't discuss a detailed neural neural substrate for this mixture generative model, we now be able to consider the corresponding circuit architecture. For example, if we consider the moderation of neural module by neuromodulator like Dopamine, it act as an attentional filter.
And this attentional filter can be explained by three factor Hebian running rule introduced in the previous slide. So again, this modulation works as the post hoc moderation plasticity. And this modulation can optimize each model to represent one generative model, one generate one song in a mutually independent manner. So, through this process, it is possible to learn multiple generative model in a vertically plausible manner. So, in summary, we found that the dynamics of kinetic neural network that minimize a cost function can be read as minimization of variational free energy.
It indicates free energy principle is an apt explanation for this type of neural network. And we also validate this prediction using some in vitro setup by showing that free energy principle can quantitatively predict the self organization of subsequent plasticity only using the initial data. And as the modeling, we can extend those canonical network modeling to the action generation as a planning via the delayed moderation of heavy emperor's DST. And finally, we discuss possibility to extend this canonical model to modeling the social or shared intelligence ah to interact with multiple partners. So, that's all of my talk.
Thank you for listening. This is Acknowledgment. Our collaborator and fundings and our unit are now recruiting postdoc researchers. So if you're interested, please check.

Daniel:
Awesome. Thank you for the presentation, Takuya. I'll just ask a few quick questions from the live chat and a few other things that come up. So Dave says Takuya used the phrase after plasticity was established. Was his group able to modify e g increase plasticity?
Or is he saying merely that it was shown that there is plasticity?

Takuya:
Yeah, I'm not sure if I understand correctly your question, but those groups show that Dopamine adding Dopamine after 2 seconds after the association occurred can change the magnitude of plasticity. So without how to say if Dopamine addition was before this association, then plasticity level is low. But after Dopamine addition after association can change this level can increase the plasticity like this or like this which indicates the post hook moderation.
Cool.

Daniel:
I think that answers it. Well, what are you excited for? Or what are your hopes or feelings on where the active inference ecosystem is at and where we're headed in the coming months and years?

Takuya:
Sorry again chris, just what are you excited about?

Daniel:
Other than your own research directions? What are you excited about in the active inference ecosystem?

Takuya:
Yeah. So, of course, one direction is the modeling of social interaction, which is much rich architecture than the interaction between the static environment.
So if both agents run with each other, then many interesting phenomena can be observed. So we are excited with modeling those phenomena using biologically plausible neural network model through this equivalence.

Daniel:
Awesome. Any last comments?
Any other comments that you want to make, Takuya?
Awesome. Thanks again for the presentation. And people should check out Live Stream 51, where you and I talked a few other times and went into some of the details on that work. There's a lot there. It's really exciting.

Takuya:
Thank you.

Daniel:
All right, thank you. See you next time.

Takuya:
See you next time.

Daniel:
Bye.
